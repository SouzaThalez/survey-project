import{$ as Z,B as G,G as K,K as Y,M as V,S as H,U as q,V as J,W as $,X as z,Y as Q,Z as W,_ as X,aa as tt,b as L,ba as et,c as d,ca as it,d as F,da as ot,e as T,fa as nt,g as U,ha as rt,ia as at,j as A,ja as lt,m as R,ma as st,p as j,q as B,r as D}from"./chunk-XY2N4D5Y.js";import{Fa as p,Ga as i,Ha as e,Hb as k,Ia as h,K as g,Mb as E,Qa as c,Ub as I,Vb as N,Xb as b,a as S,b as y,db as o,eb as w,ga as m,ka as f,na as O,oa as M,ra as C,za as x}from"./chunk-WOJ4QW3K.js";function ct(l,s){l&1&&(i(0,"mat-error"),o(1," Informe um email v\xE1lido. "),e())}function dt(l,s){l&1&&(i(0,"mat-error"),o(1," M\xEDnimo de 6 caracteres. "),e())}var _=class l{constructor(s,n,t){this.fb=s;this.snack=n;this.router=t;this.form=this.fb.nonNullable.group({email:this.fb.nonNullable.control("",{validators:[d.required,d.email]}),password:this.fb.nonNullable.control("",{validators:[d.required,d.minLength(6)]})})}USERS_KEYS=["users","usersStore"];AUTH_KEY="authUser";loading=!1;showPass=!1;form;ngOnInit(){if(localStorage.getItem(this.AUTH_KEY)){this.router.navigate(["/private"]);return}}readUsers(){let s=[];for(let r of this.USERS_KEYS)try{let a=localStorage.getItem(r);if(!a)continue;let u=JSON.parse(a);Array.isArray(u)&&s.push(...u)}catch{}let n=new Set;return s.filter(r=>{let a=(r.email||"").toLowerCase().trim();return!a||n.has(a)?!1:(n.add(a),!0)}).map(r=>y(S({},r),{role:(r.role||"").toLowerCase()==="admin"?"Admin":"Professor"}))}signIn(){if(this.form.invalid||this.loading){this.form.markAllAsTouched();return}let{email:s,password:n}=this.form.getRawValue(),t=(s||"").toLowerCase().trim();this.loading=!0;try{let r=this.readUsers();if(!r.length){this.snack.open("Nenhum usu\xE1rio cadastrado. Crie um no Painel de Usu\xE1rios.","Ok",{duration:2500});return}let a=r.find(P=>(P.email||"").toLowerCase().trim()===t&&P.password===n);if(!a){this.snack.open("Credenciais inv\xE1lidas.","Ok",{duration:2e3});return}let u={id:a.id,email:a.email,name:`${a.firstName||""} ${a.lastName||""}`.trim(),role:a.role||"Professor"};localStorage.setItem(this.AUTH_KEY,JSON.stringify(u)),this.snack.open("Login realizado!","Ok",{duration:1200}),this.router.navigate(["/private/nova-prova"])}catch{this.snack.open("Erro ao ler usu\xE1rios locais.","Ok",{duration:2e3})}finally{this.loading=!1}}goToUsers(){this.router.navigate(["/private/painel-usuario"])}static \u0275fac=function(n){return new(n||l)(f(j),f(H),f(I))};static \u0275cmp=O({type:l,selectors:[["app-login"]],standalone:!1,decls:38,vars:7,consts:[[1,"login-page"],[1,"paper"],[1,"title"],[1,"disclaimer"],["routerLink","/private/painel-usuario"],[1,"login-form",3,"ngSubmit","formGroup"],["appearance","outline"],["matInput","","type","email","formControlName","email","placeholder","seu@email.com"],["matPrefix",""],[4,"ngIf"],["matInput","","formControlName","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",3,"type"],["mat-icon-button","","type","button","matSuffix","",3,"click"],[1,"row","link-only"],[1,"link",3,"click"],[1,"actions"],["mat-button","","type","button",3,"click"],["mat-stroked-button","","color","primary","type","submit",3,"disabled"]],template:function(n,t){n&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2),o(3,"Entrar"),e(),i(4,"p",3),o(5," Acesse com seu email e senha. Para testes, voc\xEA pode criar usu\xE1rios em "),i(6,"a",4),o(7,"Painel de Usu\xE1rios"),e(),o(8,". "),e(),h(9,"mat-divider"),i(10,"form",5),c("ngSubmit",function(){return t.signIn()}),i(11,"mat-form-field",6)(12,"mat-label"),o(13,"Email"),e(),h(14,"input",7),i(15,"mat-icon",8),o(16,"mail"),e(),C(17,ct,2,0,"mat-error",9),e(),i(18,"mat-form-field",6)(19,"mat-label"),o(20,"Senha"),e(),h(21,"input",10),i(22,"button",11),c("click",function(){return t.showPass=!t.showPass}),i(23,"mat-icon"),o(24),e()(),C(25,dt,2,0,"mat-error",9),e(),i(26,"div",12)(27,"a",13),c("click",function(){return t.goToUsers()}),o(28,"Criar conta"),e()(),i(29,"div",14)(30,"button",15),c("click",function(){return t.form.reset()}),i(31,"mat-icon"),o(32,"refresh"),e(),o(33," Limpar "),e(),i(34,"button",16)(35,"mat-icon"),o(36,"login"),e(),o(37," Entrar "),e()()()()()),n&2&&(m(10),p("formGroup",t.form),m(7),p("ngIf",t.form.controls.email.touched&&t.form.controls.email.invalid),m(4),p("type",t.showPass?"text":"password"),m(),x("aria-label",t.showPass?"Ocultar senha":"Mostrar senha"),m(2),w(t.showPass?"visibility_off":"visibility"),m(),p("ngIf",t.form.controls.password.touched&&t.form.controls.password.invalid),m(9),p("disabled",t.loading||t.form.invalid))},dependencies:[k,N,Q,q,J,$,z,X,Y,K,tt,U,L,F,T,it,A,R],styles:['@charset "UTF-8";.login-page[_ngcontent-%COMP%]{background:#f2f2f2 url(/assets/bg-blur.jpg) no-repeat center/cover;min-height:100vh;min-height:100dvh;padding:24px}.login-page[_ngcontent-%COMP%]   .paper[_ngcontent-%COMP%]{max-width:480px;width:100%;margin:calc(56px + env(safe-area-inset-top)) auto 24px;background:#fff;border-radius:12px;box-shadow:0 8px 24px #00000014;padding:24px 28px}.login-page[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin:0 0 8px;font-weight:700}.login-page[_ngcontent-%COMP%]   .disclaimer[_ngcontent-%COMP%]{color:#70757a;margin:4px 0 16px}.login-page[_ngcontent-%COMP%]   .disclaimer[_ngcontent-%COMP%]   a.link[_ngcontent-%COMP%], .login-page[_ngcontent-%COMP%]   .disclaimer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#3f51b5;text-decoration:none}.login-page[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]{margin-top:14px;display:grid;gap:12px}.login-page[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;align-items:center}.login-page[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .row.link-only[_ngcontent-%COMP%]{justify-content:flex-end}.login-page[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{color:#3f51b5;cursor:pointer;-webkit-user-select:none;user-select:none}.login-page[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding-top:4px;gap:10px}@media (max-width: 600px){.login-page[_ngcontent-%COMP%]   .paper[_ngcontent-%COMP%]{margin:24px auto;padding:20px 22px}}']})};var ut=[{path:"",component:_}],v=class l{static \u0275fac=function(n){return new(n||l)};static \u0275mod=M({type:l});static \u0275inj=g({imports:[b.forChild(ut),b]})};var pt=class l{static \u0275fac=function(n){return new(n||l)};static \u0275mod=M({type:l});static \u0275inj=g({imports:[E,v,W,Z,st,V,et,B,ot,D,lt,at,rt,nt,G]})};export{pt as PublicModule};
